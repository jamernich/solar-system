<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tata Surya 3D Edukasi - NASA Textures & APOD</title>
    <style>
        body { margin: 0; overflow: hidden; background: #000; font-family: Arial, sans-serif; color: white; }
        #info { position: absolute; top: 10px; left: 10px; z-index: 100; background: rgba(0,0,0,0.8); padding: 15px; border-radius: 10px; max-width: 350px; max-height: 80vh; overflow-y: auto; }
        #info h2, #info h3 { margin: 0 0 10px; }
        #planet-info, #apod-section { margin-top: 10px; }
        #apod-img { max-width: 100%; border-radius: 5px; margin: 5px 0; }
        canvas { display: block; }
        button { background: #4CAF50; color: white; border: none; padding: 5px 10px; border-radius: 5px; cursor: pointer; margin: 5px 0; }
        button:hover { background: #45a049; }
    </style>
</head>
<body>
    <div id="info">
        <h2>ðŸŒŒ Tata Surya 3D</h2>
        <p>Klik planet untuk info. Mouse untuk zoom/rotasi. Reload untuk APOD baru.</p>
        <button onclick="loadAPOD()">Update APOD NASA</button>
        <div id="planet-info"></div>
        <div id="apod-section">
            <h3>ðŸ“¸ APOD NASA Harian</h3>
            <img id="apod-img" style="display:none;" alt="NASA APOD">
            <p id="apod-title" style="font-weight:bold;"></p>
            <p id="apod-explanation"></p>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    <script>
        // Scene setup
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.body.appendChild(renderer.domElement);

        const controls = new THREE.OrbitControls(camera, renderer.domElement);
        camera.position.z = 80;

        // Lighting
        const ambientLight = new THREE.AmbientLight(0x404040, 0.3);
        scene.add(ambientLight);
        const sunLight = new THREE.PointLight(0xffffff, 2, 1000);
        sunLight.position.set(0, 0, 0);
        scene.add(sunLight);

        // Planets data dengan texture URLs (NASA-based, free)
        const planets = [
            { name: 'â˜€ï¸ Matahari', radius: 5, distance: 0, speed: 0, texture: 'https://www.solarsystemscope.com/textures/download/2k_sun.jpg', info: 'Pusat tata surya, bintang fusi nuklir, diameter 1.4 juta km, suhu 5500Â°C.' },
            { name: 'â˜¿ Merkurius', radius: 0.5, distance: 12, speed: 0.04, texture: 'https://www.solarsystemscope.com/textures/download/2k_mercury.jpg', info: 'Planet terdekat matahari, diameter 4879 km, 88 hari mengorbit.' },
            { name: 'â™€ Venus', radius: 0.8, distance: 17, speed: 0.035, texture: 'https://www.solarsystemscope.com/textures/download/2k_venus_surface.jpg', info: 'Planet terpanas (460Â°C), atmosfer CO2 tebal, mirip ukuran Bumi.' },
            { name: 'ðŸŒ Bumi', radius: 1, distance: 22, speed: 0.01, texture: 'https://www.solarsystemscope.com/textures/download/2k_earth_daymap.jpg', info: 'Rumah kita, diameter 12742 km, 365 hari mengorbit, punya kehidupan.' },
            { name: 'â™‚ Mars', radius: 0.7, distance: 28, speed: 0.008, texture: 'https://www.solarsystemscope.com/textures/download/2k_mars.jpg', info: 'Planet merah, diameter 6779 km, potensi air es, misi Perseverance NASA.' },
            { name: 'ðŸ”´ Jupiter', radius: 3.5, distance: 40, speed: 0.002, texture: 'https://www.solarsystemscope.com/textures/download/2k_jupiter.jpg', info: 'Planet terbesar, gas raksasa, 79 bulan, diameter 139820 km.' },
            { name: 'ðŸŸ¡ Saturnus', radius: 3, distance: 52, speed: 0.0018, texture: 'https://www.solarsystemscope.com/textures/download/2k_saturn.jpg', info: 'Cincin es/batu indah, 82 bulan, diameter 116460 km.' },
            { name: 'ðŸŸ¢ Uranus', radius: 1.8, distance: 62, speed: 0.0012, texture: 'https://www.solarsystemscope.com/textures/download/2k_uranus.jpg', info: 'Planet miring 98Â°, 27 bulan, ditemukan 1781.' },
            { name: 'ðŸ”µ Neptunus', radius: 1.8, distance: 72, speed: 0.0009, texture: 'https://www.solarsystemscope.com/textures/download/2k_neptune.jpg', info: 'Angin tercepat 2000 km/jam, 14 bulan, paling jauh.' }
        ];

        const planetMeshes = [];
        const loader = new THREE.TextureLoader();

        planets.forEach((planet, index) => {
            loader.load(planet.texture, (texture) => {
                const geometry = new THREE.SphereGeometry(planet.radius, 64, 64);
                const material = new THREE.MeshStandardMaterial({ 
                    map: texture,
                    roughness: index === 0 ? 0.1 : 0.9,
                    metalness: index === 0 ? 1 : 0.1
                });
                const mesh = new THREE.Mesh(geometry, material);
                mesh.position.x = planet.distance;
                mesh.userData = { ...planet, angle: Math.random() * Math.PI * 2 };
                scene.add(mesh);
                planetMeshes.push(mesh);
            });
        });

        // Stars
        const starsGeometry = new THREE.BufferGeometry();
        const starsMaterial = new THREE.PointsMaterial({ color: 0xffffff, size: 0.1 });
        const starsVertices = [];
        for (let i = 0; i < 10000; i++) {
            starsVertices.push((Math.random() - 0.5) * 2000);
            starsVertices.push((Math.random() - 0.5) * 2000);
            starsVertices.push((Math.random() - 0.5) * 2000);
        }
        starsGeometry.setAttribute('position', new THREE.Float32BufferAttribute(starsVertices, 3));
        const stars = new THREE.Points(starsGeometry, starsMaterial);
        scene.add(stars);

        // Raycaster
        const raycaster = new THREE.Raycaster();
        const mouse = new THREE.Vector2();
        function onMouseClick(event) {
            mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
            mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;
            raycaster.setFromCamera(mouse, camera);
            const intersects = raycaster.intersectObjects(planetMeshes);
            if (intersects.length > 0) {
                const planet = intersects[0].object.userData;
                document.getElementById('planet-info').innerHTML = `<h3>${planet.name}</h3><p>${planet.info}</p>`;
            }
        }
        window.addEventListener('click', onMouseClick);

        // NASA APOD API
        async function loadAPOD() {
            try {
                const response = await fetch('https://api.nasa.gov/planetary/apod?api_key=DEMO_KEY');
                const data = await response.json();
                const img = document.getElementById('apod-img');
                const title = document.getElementById('apod-title');
                const expl = document.getElementById('apod-explanation');
                img.src = data.url || data.hdurl;
                img.style.display = 'block';
                title.textContent = data.title;
                expl.textContent = data.explanation.substring(0, 150) + '...';
            } catch (error) {
                document.getElementById('apod-explanation').textContent = 'Error loading APOD. Coba lagi atau gunakan API key pribadi dari api.nasa.gov.';
            }
        }
        loadAPOD(); // Load otomatis

        // Animate
        function animate() {
            requestAnimationFrame(animate);
            planetMeshes.forEach((mesh, index) => {
                if (index > 0) {
                    mesh.userData.angle += mesh.userData.speed;
                    mesh.position.x = Math.cos(mesh.userData.angle) * mesh.userData.distance;
                    mesh.position.z = Math.sin(mesh.userData.angle) * mesh.userData.distance;
                    mesh.rotation.y += 0.01;
                } else {
                    mesh.rotation.y += 0.005;
                }
            });
            stars.rotation.y += 0.0003;
            controls.update();
            renderer.render(scene, camera);
        }
        animate();

        // Resize
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });
    </script>
</body>
</html>
